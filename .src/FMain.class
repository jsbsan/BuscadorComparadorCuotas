' Gambas class file

Public Sub Form_Open()

    TextLabelVersion.text = "Versión: " & Application.Version
    defineGridViewSportiumFutbol()
    defineGridViewMbetFutbol()
    defineGridViewWillianHillFutbol()
    defineGridViewLuckiaFutbol()
    defineGridViewGoldenFutbol()
    defineGridViewBetStars()

End

Public Sub defineGridViewGoldenFutbol()

    With GridViewGoldenPark
        .header = 3
        .rows.count = 0
        .columns.count = 9
        .Columns[0].title = "E"
        .Columns[1].title = "Hora"
        .Columns[2].title = "Fecha"
        .Columns[3].title = "Equipo1"
        .Columns[4].title = "Cuota 1"
        .Columns[5].title = "Empate"
        .Columns[6].title = "Cuota X"
        .Columns[7].title = "Equipo2"
        .Columns[8].title = "Cuota 2"
        .columns[7].width = 150
        .columns[3].width = 150
        .font.name = "Sans"
        .font.size = 9

    End With

End

Public Sub defineGridViewBetStars()

    With GridViewBetStars
        .header = 3
        .rows.count = 0
        .columns.count = 9
        .Columns[0].title = "E"
        .Columns[1].title = "Hora"
        .Columns[2].title = "Fecha"
        .Columns[3].title = "Equipo1"
        .Columns[4].title = "Cuota 1"
        .Columns[5].title = "Empate"
        .Columns[6].title = "Cuota X"
        .Columns[7].title = "Equipo2"
        .Columns[8].title = "Cuota 2"
        .columns[7].width = 150
        .columns[3].width = 150
        .font.name = "Sans"
        .font.size = 9

    End With

End

Public Sub defineGridViewLuckiaFutbol()

    With GridViewLuckiaFutbol
        .header = 3
        .rows.count = 0
        .columns.count = 9
        .Columns[0].title = "E"
        .Columns[1].title = "Hora"
        .Columns[2].title = "Fecha"
        .Columns[3].title = "Equipo1"
        .Columns[4].title = "Cuota 1"
        .Columns[5].title = "Empate"
        .Columns[6].title = "Cuota X"
        .Columns[7].title = "Equipo2"
        .Columns[8].title = "Cuota 2"
        .columns[7].width = 150
        .columns[3].width = 150
        .font.name = "Sans"
        .font.size = 9

    End With

End

Public Sub defineGridViewMbetFutbol()

    With GridViewMBetFutbol
        .header = 3
        .rows.count = 0
        .columns.count = 9
        .Columns[0].title = "E"
        .Columns[1].title = "Hora"
        .Columns[2].title = "Fecha"
        .Columns[3].title = "Equipo1"
        .Columns[4].title = "Cuota 1"
        .Columns[5].title = "Empate"
        .Columns[6].title = "Cuota X"
        .Columns[7].title = "Equipo2"
        .Columns[8].title = "Cuota 2"
        .columns[7].width = 150
        .columns[3].width = 150
        .font.name = "Sans"
        .font.size = 9

    End With

End

Public Sub defineGridViewWillianHillFutbol()

    With GridViewWillianHillFutbol
        .header = 3
        .rows.count = 0
        .columns.count = 9
        .Columns[0].title = "E"
        .Columns[1].title = "Hora"
        .Columns[2].title = "Fecha"
        .Columns[3].title = "Equipo1"
        .Columns[4].title = "Cuota 1"
        .Columns[5].title = "Empate"
        .Columns[6].title = "Cuota X"
        .Columns[7].title = "Equipo2"
        .Columns[8].title = "Cuota 2"
        .columns[7].width = 150
        .columns[3].width = 150
        .font.name = "Sans"
        .font.size = 9

    End With

End

Public Sub defineGridViewSportiumFutbol()

    With GridViewSportiumFutbol
        .header = 3
        .rows.count = 0
        .columns.count = 9
        .Columns[0].title = "E"
        .Columns[1].title = "Hora"
        .Columns[2].title = "Fecha"
        .Columns[3].title = "Equipo1"
        .Columns[4].title = "Cuota 1"
        .Columns[5].title = "Empate"
        .Columns[6].title = "Cuota X"
        .Columns[7].title = "Equipo2"
        .Columns[8].title = "Cuota 2"
        .columns[7].width = 150
        .columns[3].width = 150
        .font.name = "Sans"
        .font.size = 9

    End With

End

Public Sub ButtonLeerDatosSportium_Click()

    Dim lineas As String[]
    Dim contador As Integer
    Dim fila As Integer
    Dim HayEstadisticas As String
    Dim comprobarLinea As String

    lineas = Split(TextAreaSportiumFutbol.text, "\n")

    ''estructura de los datos de sportium 16/08/2018
    ' estrella
    ' hora
    ' fecha
    ' espacio
    ' nombre1
    ' cuota1
    ' espacio
    ' X
    ' cuotaX
    ' espacio
    ' nombre2
    ' cuota2
    ' apuestas_disponibles
    ' icono_estadistica
    If lineas[0] = "" Then
        'elimino la primera linea
        lineas.Delete(0)
    Endif
    contador = -1

    While (contador < (lineas.Count - 1))
        fila += 1
        contador += 1

        GridViewSportiumFutbol.rows.count = fila + 1
        Comun.limpiaFilaActual(GridViewSportiumFutbol, fila)

        Try GridViewSportiumFutbol[fila - 1, 0].text = "0_Sportium" 'EstrellaS
        contador += 1
        Try GridViewSportiumFutbol[fila - 1, 1].text = lineas[contador] 'hora
        contador += 1
        Try GridViewSportiumFutbol[fila - 1, 2].text = lineas[contador] 'fecha

        Try comprobarLinea = Mid$(lineas[contador + 1], 1, 4)
        If comprobarlinea = "Ver " Then
            contador += 1  ' linea que pone: Ver Gratis online
        Endif

        contador += 1  'espacio
        'para pasar la linea vacia...

        contador += 1
        Try GridViewSportiumFutbol[fila - 1, 3].text = lineas[contador] 'nombre1

        contador += 1
        Try GridViewSportiumFutbol[fila - 1, 4].text = lineas[contador] 'cuota1
        contador += 1  'espacio
        contador += 1
        Try GridViewSportiumFutbol[fila - 1, 5].text = "Empate" 'lineas[contador] 'empate texto
        contador += 1
        Try GridViewSportiumFutbol[fila - 1, 6].text = lineas[contador] 'cuotax
        contador += 1  'espacio

        contador += 1
        Try GridViewSportiumFutbol[fila - 1, 7].text = lineas[contador] 'nombre2
        contador += 1
        Try GridViewSportiumFutbol[fila - 1, 8].text = lineas[contador] 'cuota2
        contador += 1 'apuesta disponibles
        Try GridViewSportiumFutbol[fila - 1, 9].text = lineas[contador] 'apuestas disponibles

        Try HayEstadisticas = lineas[contador + 1]
        If HayEstadisticas = "st" Then
            contador += 1 'apuesta icono estadistica

        Endif
    Wend

    TextAreaSportiumFutbol.Pos = 1

End

Public Sub ButtonLeerDatosMBETFutbol_Click()

    Dim lineas As String[]
    Dim contador As Integer
    Dim fila As Integer
    Dim datoLinea1 As String
    Dim DatosCuotas As String[]
    Dim Sintabulador As String

    If Mid$(TextAreaMbetButbol.text, 1, 1) = "\n" Then
        TextAreaMbetButbol.text = Mid$(TextAreaMbetButbol.text, 2, Len(TextAreaMbetButbol.text))
    Endif

    lineas = Split(TextAreaMbetButbol.text, "\n")
    ''estructura de los datos de sportium 16/08/2018
    ' linea1:
    ' 	1. nombre
    ' 	\t
    ' 	\t
    ' 	fecha
    ' 	punto
    ' 	hora
    ' linea2
    ' 	2. nombre
    ' linea3
    ' 	numeroapuetas
    ' linea4
    ' 	cuota1
    ' 	\ t
    ' cuotaX
    ' 	\ t
    ' 	cuota2

    'limpoieza de zona con Nombre del evento y Liga de las Naciones
    contador = 0
    While (contador < (lineas.max))

        If Mid$(lineas[contador], 1, 17) = "Nombre del evento" Then
            lineas.Delete(contador)
            contador -= 1
        Else
            If Mid$(lineas[contador], 1, Len("Liga de las Naciones")) = "Liga de las Naciones" Then
                lineas.Delete(contador)
                contador -= 1
            Endif
        Endif

        contador += 1
    Wend

    'empiezo a leer
    contador = -1

    While (contador < (lineas.Count - 1))
        fila += 1

        GridViewMBetFutbol.rows.count = fila + 1
        Comun.limpiaFilaActual(GridViewMBetFutbol, fila)
        'Analisis linea1
        contador += 1
        Try datoLinea1 = lineas[contador]

        Try GridViewMBetFutbol[fila - 1, 3].text = Mid$(datoLinea1, 3, InStr(datoLinea1, "\t") - 3) 'nombre1 'le quito el 1.

        'Para saber si tiene puesto la fecha o no"

        If Len(Mid$(datolinea1, InStr(datoLinea1, "\t\t") + 2, Len(datolinea1))) = 5 Then
            Try GridViewMBetFutbol[fila - 1, 2].text = Format$(Now, "dd mmm") 'fecha
            Try GridViewMBetFutbol[fila - 1, 1].text = Mid$(datoLinea1, RInStr(datoLinea1, "\t") + 1, Len(datolinea1)) 'hora

        Else
            Try GridViewMBetFutbol[fila - 1, 2].text = Mid$(datoLinea1, InStr(datoLinea1, "\t") + 2, 6) 'fecha
            Try GridViewMBetFutbol[fila - 1, 1].text = Mid$(datoLinea1, RInStr(datoLinea1, ".") + 2, Len(datolinea1)) 'hora

        Endif

        'Analisis linea2
        contador += 1
        Try GridViewMBetFutbol[fila - 1, 7].text = Mid$(lineas[contador], 3, Len(lineas[contador])) 'nombre2' le quito el 2.

        'Analisis linea3
        contador += 1
        Try GridViewMBetFutbol[fila - 1, 9].text = lineas[contador] 'apuestas disponibles
        'Analisis linea4
        contador += 1

        Try DatosCuotas = Split(lineas[contador], "\t")
        Try GridViewMBetFutbol[fila - 1, 4].text = DatosCuotas[0] 'cuota1
        Try GridViewMBetFutbol[fila - 1, 6].text = DatosCuotas[1] 'cuotax
        Try GridViewMBetFutbol[fila - 1, 8].text = DatosCuotas[2] 'cuota2
        Try GridViewMBetFutbol[fila - 1, 0].text = "MBet" 'Estrella: casa mbet
    Wend
    TextAreaMbetButbol.pos = 1

End

Public Sub Combinar(gridviewOtro As GridView)

    Dim contador As Integer
    Dim datosCSV As String

    Clipboard.Clear() 'limpio portapapeles
    contador = -1
    '  datosCSV = "Casa\tHora\tFecha\tEquipo1\tCuota1\tEmpate\tCuotaX\tEquipo2\tCuota2\n"

    While (contador < GridViewMBetFutbol.Rows.Count)
        contador += 1
        datosCSV &= textofila(GridViewMBetFutbol, contador)
    Wend

    contador = -1
    While (contador < gridviewOtro.Rows.Count)
        contador += 1
        datosCSV &= textofila(gridviewOtro, contador)
    Wend

    'ordenar filas...
    datosCSV = ordenar(datosCSV)

    'añado cabecera:

    datosCSV = "Casa\tHora\tFecha\tEquipo1\tCuota1\tEmpate\tCuotaX\tEquipo2\tCuota2\n" & datosCSV

    'el resultado lo copio al portapapeles
    Clipboard.Copy(datosCSV)

    FormHECHO.Show()

End

Public Function ordenar(texto As String) As String

    Dim listaOrigen As String[]
    Dim listaTemporal As New String[]
    Dim listaOrdenada As New String[]
    Dim lineaOrdenada As String
    Dim TextoOrdenado As String
    Dim linea As String
    Dim nuevalinea As String[]

    listaOrigen = Split(texto, "\n")

    'intercambio de columnas
    For Each linea In ListaOrigen
        If Trim(linea) = "" Then Continue

        nuevalinea = Split(linea, "\t")
        'reoordeno
        '"Casa\tHora\tFecha\tEquipo1\tCuota1\tEmpate\tCuotaX\tEquipo2\tCuota2\n"
        '   0     1     2      3        4       5       6        7      8
        'Ordeno: fecha/hora/Equipo1/Casa ->
        'recorto el nombre del equipo 1 para facilitar la ordenacion, y lo añado completo al final para poderlo recuperar
        'caracteres para ordenar por nombre: pongo que coja los 4 primeros (tambien añado espacios por si el nombre es mas corto)
        lineaOrdenada = Upper$(nuevalinea[2]) & "\t" & Comun.normalizacion(nuevalinea[3]) & "\t" & nuevalinea[0] & "\t" & nuevalinea[4] & "\t" & nuevalinea[5] & "\t" & nuevalinea[6] & "\t" & nuevalinea[7] & "\t" & nuevalinea[8] & "\t" & nuevalinea[3] & "\t" & nuevalinea[1]
        'la hora la pongo al final (depende de la casa, algunas veces pone horas distintas de inicio del partido)

        'comprobación de vacios
        If nuevalinea[2] & nuevalinea[3] & nuevalinea[7] = "" Then
            'la linea esta vacia, no la añado...
        Else

            'añado a la listaTemporal
            listaTemporal.add(lineaOrdenada)
        Endif
    Next

    'ordeno la lista temporal con las columnas cambiadas
    listaOrdenada = listaTemporal.Sort(gb.Ascent)

    'intercambio de columnas
    For Each linea In ListaOrdenada
        nuevalinea = Split(linea, "\t")
        'reoordeno
        'Ordeno: fecha/hora/Equipo1/Casa ->
        '          0     1     2->9!     3
        'a
        '"Casa\tHora\tFecha\tEquipo1\tCuota1\tEmpate\tCuotaX\tEquipo2\tCuota2\n" -> la 9 tiene el nombre completo
        '   0     1     2      3        4       5       6        7      8
        'y la diez contiene la hora
        'ORDENOR POR:
        ' FECHA (3),
        lineaOrdenada = nuevalinea[2] & "\t" & nuevalinea[9] & "\t" & nuevalinea[0] & "\t" & nuevalinea[8] & "\t" & nuevalinea[3] & "\t" & nuevalinea[4] & "\t" & nuevalinea[5] & "\t" & nuevalinea[6] & "\t" & nuevalinea[7] & "\n"

        TextoOrdenado &= lineaOrdenada
    Next

    Return TextoOrdenado

End

Public Sub ButtonCombinarSportiumMbet_Click()

    Combinar(GridViewSportiumFutbol)

End

Public Function textofila(grid As GridView, i As Integer) As String

    Dim contador As Integer
    Dim texto As String

    contador = -1

    While (contador < (grid.columns.count - 1))
        contador += 1
        If contador = 4 Or contador = 6 Or contador = 8 Then
            'solo reemplaza cuando hay numero de cuotas en las columnas
            Try texto &= Replace(RTrim(grid[i, contador].text), ".", ",") & "\t"
        Else
            Try texto &= Replace(RTrim(grid[i, contador].text), "\t", "") & "\t" 'por si los datos contienen algun \t no previsto, lo quita, y solo añado el que me interesa
        Endif
    Wend

    Return texto & "\n"

End

Public Sub ButtonLimpiarSportium_Click()

    TextAreaSportiumFutbol.text = ""
    GridViewSportiumFutbol.rows.count = 0

End

Public Sub ButtonLimpiarMbetDatos_Click()

    TextAreaMbetButbol.text = ""
    GridViewMBetFutbol.Rows.count = 0

End

Public Sub ButtonLimpiarWillianHill_Click()

    TextAreaWillianHIll.text = ""
    GridViewWillianHillFutbol.Rows.count = 0

End

Public Sub ButtonGridLimpiarWillianhill_Click()

    GridViewWillianHillFutbol.Rows.count = 0

End

Public Sub ButtonGridLimpiarMBet_Click()

    GridViewMBetFutbol.Rows.count = 0

End

Public Sub ButtonGridLimpiarWillianhill3_Click()

    GridViewSportiumFutbol.rows.count = 0

End

Public Sub ButtonLeerDatosWillianHill_Click()

    ''estructura de datos
    ' Directo
    ' 20: 15 ES Girona - Valladolid
    ' 1.75
    ' 3.60
    ' 4.60
    ' + 233 Apuestas
    '  Estad ísticas
    ' A ñadir a mis favoritos
    ' 18 Ago 20: 15 ES Villarreal - Real Sociedad
    ' 2.05
    ' 3.30
    ' 3.60
    ' + 256 Apuestas
    '  Estad ísticas
    ' A ñadir a mis favoritos
    Dim lineas As String[]
    Dim contador As Integer
    Dim fila As Integer
    Dim DatoColumnafecha As Boolean
    Dim contenido As String
    Dim lineaAnalizar As String

    lineas = Split(TextAreaWillianHIll.text, "\n")

    contador = -1
    'Normalizo el inicio de la lectura de datos
    'comprobacion inicial de estructura espacio-ganador del partido 1 x 2"
    If lineas[0] = "Ganador del partido" Then lineas.Add("", 0)

    If lineas[0] = "" And lineas[1] = "Ganador del partido" And lineas[2] = "1" And lineas[3] = "X" And lineas[4] = "2" Then
        lineas.Delete(0, 5)
    Endif

    If lineas[0] = "" Then lineas.Delete(0, 1) 'borra linea 0, si esta vacia...

    While (contador < (lineas.Count - 1))
        fila += 1
        contador += 1
        DatoColumnafecha = False
        GridViewWillianHillFutbol.rows.count = fila + 1
        Comun.limpiaFilaActual(GridViewWillianHillFutbol, fila)

        If lineas[contador] = "Directo" Then
            Try GridViewWillianHillFutbol[fila - 1, 2].text = Format$(Now, "dd mmm") 'fecha
            contador += 1
            DatoColumnafecha = True

        Endif

        'leo fecha hora nombre equipo 1 y nombre equipo 2
        contenido = lineas[contador]
        If DatoColumnaFecha = True Then

            Try GridViewWillianHillFutbol[fila - 1, 1].text = Mid$(contenido, 1, 5) 'hora
            Try GridViewWillianHillFutbol[fila - 1, 3].text = String.Mid$(contenido, 10, String.InStr(contenido, " - ") - 10) 'nombre1

        Else

            Try GridViewWillianHillFutbol[fila - 1, 2].text = Mid$(contenido, 1, 6) 'fecha
            Try GridViewWillianHillFutbol[fila - 1, 1].text = Mid$(contenido, 8, 5) 'hora

            GridViewWillianHillFutbol[fila - 1, 3].text = String.Mid$(contenido, 17, string.InStr(contenido, " - ") - 17) 'nombre1

        Endif

        Try GridViewWillianHillFutbol[fila - 1, 7].text = String.Mid$(contenido, String.InStr(contenido, " - ") + 5, Len(contenido)) 'nombre2

        contador += 1
        Try GridViewWillianHillFutbol[fila - 1, 4].text = lineas[contador] 'cuota1

        contador += 1
        Try GridViewWillianHillFutbol[fila - 1, 6].text = lineas[contador] 'cuotax
        contador += 1
        Try GridViewWillianHillFutbol[fila - 1, 8].text = lineas[contador] 'cuota2
        Try GridViewWillianHillFutbol[fila - 1, 0].text = "0_WillianHill" 'Estrella: casa  willian hill

        contador += 1
        Try lineaAnalizar = lineas[contador]
        If Mid(lineaAnalizar, 1, 1) = "+" Then
            'hay linea de numero de apuestas
            '+ 258 Apuestas
        Else
            contador -= 1
        Endif

        contador += 1 ' Estadísticas
        Try lineaAnalizar = lineas[contador]
        If Mid$(lineaAnalizar, 1, 5) = " Esta" Or Mid$(lineaAnalizar, 1, 3) = "TV\t" Then
            'hay estadisticas y/o linea de television
        Else
            contador -= 1
        Endif

        contador += 1 'Añadir a mis favoritos
        Try lineaAnalizar = lineas[contador]
        If Mid$(lineaAnalizar, 1, 5) = "Añad" Then
            'hay estrella de añadir a mis favoritos
        Else
            contador -= 1
        Endif

    Wend

    TextAreaWillianHIll.pos = 1

End

Public Sub ButtonCombinarWillianHIllMbet_Click()

    Combinar(GridViewWillianHillFutbol)

End

' Public Sub ButtonGridLimpiarMBet_Click()
'
'     GridViewMBetFutbol.Rows.count = 0
'
' End

Public Sub ButtonGridLimpiarLuckia_Click()

    GridViewLuckiaFutbol.Rows.count = 0

End

Public Sub ButtonLimpiarLuckia_Click()

    TextAreaLuckiaFutbol.text = ""
    GridViewLuckiaFutbol.Rows.count = 0

End

Public Sub ButtonLeerDatosLuckia_Click()

    Dim lineas As String[]
    Dim contador As Integer
    Dim fila As Integer
    Dim HayEspacio As String
    Dim contenido As String
    Dim a As Integer 'contador para for next

    lineas = Split(TextAreaLuckiaFutbol.text, "\n")

    ''estructura de los datos de luckia 16/08/2018
    '1ºeliminar las lineas que sean: 1X2 FT

    For a = 0 To lineas.count - 1
        Try contenido = lineas[a]
        If contenido = "1X2 FT" Then
            lineas.delete(a)
        Endif
    Next

    '2º Eliminar las lineas que se incien con Hoy,Mañana,Lunes,Martes,Miercoles...'

    For a = 0 To lineas.count - 1

        eliminaLinea(lineas, a, ["Hoy", "Mañana", "Lunes", "Martes", "Miércoles", "Jueves", "Viernes", "Sábado", "Domingo"])

    Next

    ' fecha
    ' equipo 1
    ' hora
    ' equipo 2
    ' espacio
    ' equipo 1
    ' cuota 1
    ' espacio
    ' Empate
    ' cuota empate
    ' espacio
    ' equipo 2
    '  cuota 2
    ' numero de apuesta
    'espacio o linea elminada, y coincide con fecha...

    contador = -1

    While (contador < (lineas.Count - 1))
        fila += 1
        contador += 1

        GridViewLuckiaFutbol.rows.count = fila + 1
        Comun.limpiaFilaActual(GridViewLuckiaFutbol, fila)

        Try GridViewLuckiaFutbol[fila - 1, 0].text = "0_Luckia" 'Estrellas 1º columna

        Try GridViewLuckiaFutbol[fila - 1, 2].text = Comun.ConvierteFechaLuckia(lineas[contador]) 'fecha

        contador += 1
        Try GridViewLuckiaFutbol[fila - 1, 3].text = lineas[contador] 'nombre1

        contador += 1
        Try GridViewLuckiaFutbol[fila - 1, 1].text = lineas[contador] 'hora

        contador += 1
        Try GridViewLuckiaFutbol[fila - 1, 7].text = lineas[contador] 'nombre2

        contador += 1  'espacio

        contador += 1  'equipo 1 repetido

        contador += 1
        Try GridViewLuckiaFutbol[fila - 1, 4].text = lineas[contador] 'cuota1

        contador += 1  'espacio

        contador += 1
        Try GridViewLuckiaFutbol[fila - 1, 5].text = "Empate" 'lineas[contador] 'empate texto

        contador += 1
        Try GridViewLuckiaFutbol[fila - 1, 6].text = lineas[contador] 'cuotax

        contador += 1  'espacio

        contador += 1 'nombre repetido equipo 2

        contador += 1
        Try GridViewLuckiaFutbol[fila - 1, 8].text = lineas[contador] 'cuota2

        contador += 1 'apuesta disponibles
        Try GridViewLuckiaFutbol[fila - 1, 9].text = lineas[contador] 'apuestas disponibles

        Try HayEspacio = lineas[contador + 1]
        If HayEspacio = "" Then
            contador += 1 'hay un espacio

        Endif
    Wend
    TextAreaLuckiaFutbol.pos = 1

End

Public Sub eliminalinea(cadena As String[], a As Integer, lista As String[])
    ' Dado una array de cadenas, con el valor del indice por donde vamos iterinando,
    ' comparo la parte inicial de la cadena con los valores de la lista, y si coinciden elimina ese valor del array cadena

    Dim i As Integer

    If a > (cadena.count - 1) Then Return 'se ha eliminado alguna linea,y el contador a superado el numero de elementos del array

    For i = 0 To lista.Max
        If Mid$(cadena[a], 1, Len(lista[i])) = lista[i] Then
            cadena.Delete(a)
            Return
        Endif
    Next

    Return

End

Public Sub ButtonCombinarLuckiaMbet_Click()

    Combinar(GridViewLuckiaFutbol)

End

Public Sub ButtonCombinarGoldenParkMBet_Click()

    Combinar(GridViewGoldenPark)

End

Public Sub ButtonCombinarCodereMbet_Click()

    ' Dim contador As Integer
    ' Dim datosCSV As String
    '
    ' Clipboard.Clear() 'limpio portapapeles
    ' contador = -1
    ' datosCSV = "Casa\tHora\tFecha\tPartido1\tEquipo1\tEmpate\tCuotaX\tEquipo2\tCuota2\n"
    ' While (contador < GridViewMBetFutbol.Rows.Count)
    '     contador += 1
    '     datosCSV &= textofila(GridViewMBetFutbol, contador)
    ' Wend
    ' contador = -1
    ' While (contador < GridViewCodereFutbol.Rows.Count)
    '     contador += 1
    '     datosCSV &= textofila(GridViewCodereFutbol, contador)
    ' Wend
    '
    ' Clipboard.Copy(datosCSV)
    '
    ' Message.Info("Terminado, en el portapapeles esta el contenido de los dos gridview")

End

Public Sub ButtonGridLimpiarCodere_Click()

    GridViewCodereFutbol.Rows.count = 0

End

Public Sub ButtonGridLimpiarGoldenPark_Click()

    GridViewGoldenPark.Rows.count = 0

End

Public Sub ButtonLimpiarGoldenPark_Click()

    TextAreaGoldenParkFutbol.text = ""
    GridViewGoldenPark.Rows.count = 0

End

Public Sub ButtonLimpiarCodere_Click()

    TextAreaCodereFutbol.text = ""
    GridViewCodereFutbol.Rows.count = 0

End

Public Sub ButtonLeerDatosGoldenPark_Click()

    Dim lineas As String[]
    Dim contador As Integer
    Dim fila As Integer
    Dim equipos As New String[]

    lineas = Split(TextAreaGoldenParkFutbol.text, "\n")

    ''estructura de los datos de goldenpark 19/08/2018
    ' Destacados 1 X 2
    ' fecha:MesDia
    ' hora
    ' nombre1 + " v " + nombre 2
    ' cuota 1
    ' cuota X
    ' cuota 2
    ' apuestas_disponibles

    'borro la primera linea "Destacados 1 X 2'
    If lineas[0] = "Destacados	1	X	2	" Then
        lineas.delete(0)
    Endif

    contador = -1

    While (contador < (lineas.Count - 1))
        fila += 1
        contador += 1

        GridViewGoldenPark.rows.count = fila + 1
        Comun.limpiaFilaActual(GridViewGoldenPark, fila)

        Try GridViewGoldenPark[fila - 1, 0].text = "0_GoldenPark" 'Casa de Apuesta

        Try GridViewGoldenPark[fila - 1, 2].text = Mid$(lineas[contador], 4, 2) & " " & Mid$(lineas[contador], 1, 3) 'fecha

        contador += 1
        Try GridViewGoldenPark[fila - 1, 1].text = lineas[contador] 'hora

        equipos.Clear()
        contador += 1
        Try equipos = Split(Replace(lineas[contador], " v ", "|"), "|")

        Try GridViewGoldenPark[fila - 1, 3].text = equipos[0] 'nombre1

        Try GridViewGoldenPark[fila - 1, 7].text = equipos[1] 'nombre2

        contador += 1
        Try GridViewGoldenPark[fila - 1, 4].text = lineas[contador] 'cuota1

        Try GridViewGoldenPark[fila - 1, 5].text = "" 'lineas[contador] 'empate texto

        contador += 1
        Try GridViewGoldenPark[fila - 1, 6].text = lineas[contador] 'cuotax

        contador += 1
        Try GridViewGoldenPark[fila - 1, 8].text = lineas[contador] 'cuota2

        contador += 1 'apuesta disponibles
        Try GridViewGoldenPark[fila - 1, 9].text = lineas[contador] 'apuestas disponibles

    Wend
    TextAreaGoldenParkFutbol.pos = 1

End

Public Sub PegarDAtos(t As TextArea)

    t.text = Clipboard.Paste()
    t.pos = 1

End

Public Sub ButtonPegarSportium_Click()

    PegarDAtos(TextAreaSportiumFutbol)

End

Public Sub ButtonPegarWillianHIll_Click()

    PegarDAtos(TextAreaWillianHIll)

End

Public Sub ButtonPegarLuckia_Click()

    PegarDAtos(TextAreaLuckiaFutbol)

End

Public Sub ButtonPegarGolden_Click()

    PegarDAtos(TextAreaGoldenParkFutbol)

End

Public Sub ButtonPegarMbet_Click()

    PegarDAtos(TextAreaMbetButbol)

End

Public Sub ButtonGridLimpiarBetStars_Click()

    GridViewBetStars.Rows.count = 0

End

Public Sub ButtonLimpiarBetStars_Click()

    TextAreaBetStarsFutbol.text = ""
    GridViewBetStars.Rows.count = 0

End

Public Sub ButtonPegarBetStars_Click()

    PegarDAtos(TextAreaBetStarsFutbol)

End

Public Sub ButtonCombinarGoldenParkMBet2_Click()

    Combinar(GridViewBetStars)

End

Public Sub ButtonLeerDatosBetStars_Click()

    Dim lineas As String[]
    Dim contador As Integer
    Dim fila As Integer
    Dim equipos As New String[]
    Dim inicialLetra As String
    Dim fechaactual As String

    lineas = Split(TextAreaBetStarsFutbol.text, "\n")

    ''estructura de los datos de betstar 21/09/2018
    ' Resultado del partido
    ' fecha "vie. 21 sep." ->"vie.","sáb","dom","lun","mar.","mié.","jue."
    ' Local
    ' Empate
    ' Visitante
    ' nombre1
    ' nombre2
    ' apuestas_rapida
    'cuota1
    'cuotaX
    'cuotaY
    'hora (quita espacio blanco delante, y quedarse con los 5 primeros caracteres)
    'y si hay un mismo partido en ese dia, pone nombre del partido, sino pasa al siguiente dia'

    'borro la primera linea "Destacados 1 X 2'
    If lineas[0] = "Resultado del partido" Then
        lineas.delete(0)
    Endif

    contador = -1

    While (contador < (lineas.Count - 1))
        fila += 1
        contador += 1

        GridViewBetStars.rows.count = fila + 1
        Comun.limpiaFilaActual(GridViewBetStars, fila)

        Try GridViewBetStars[fila - 1, 0].text = "0_BetStars" 'Casa de Apuesta

        'si primera letra es nombre de dia, es una fecha la linea, sino, es una hora...
        inicialLetra = Upper$(Mid$(lineas[contador], 1, 1))
        If esletra(inicialLetra) = True Then

            'se trada de una fecha
            Try GridViewBetStars[fila - 1, 2].text = Trim(String.Mid$(lineas[contador], 5, 7)) 'fecha -> cambiar mes por numero
            fechaactual = String.Mid$(lineas[contador], 5, 7)
        Else
            'se trada de una hora
            ''Try GridViewBetStars[fila - 1, 1].text = Mid$(Trim(lineas[contador]), 1, 6) 'hora
            Try GridViewBetStars[fila - 1, 2].text = Trim(fechaactual)

        Endif

        If String.Mid$(lineas[contador], 1, 1) = " " Then contador -= 1 'por si es un nombre de equipo, ya que lleva delante un espacio.

        contador += 1
        'elimino Local Empate Visistante'
        If lineas[contador] = "Local" Then lineas.delete(contador)
        If lineas[contador] = "Empate" Then lineas.delete(contador)
        If lineas[contador] = "Visitante" Then lineas.delete(contador)

        equipos.Clear()
        Try GridViewBetStars[fila - 1, 3].text = Trim(lineas[contador]) 'nombre1

        contador += 1
        Try GridViewBetStars[fila - 1, 7].text = Trim(lineas[contador]) 'nombre2

        contador += 1
        'linea de apuestas rapida
        'puede que no halla... lo compruebo:
        If InStr(lineas[contador], ".") <> 0 Then contador -= 1 ' es una cuota, no descuento la linea

        contador += 1
        Try GridViewBetStars[fila - 1, 4].text = lineas[contador] 'cuota1

        contador += 1
        Try GridViewBetStars[fila - 1, 6].text = lineas[contador] 'cuotax

        contador += 1
        Try GridViewBetStars[fila - 1, 8].text = lineas[contador] 'cuota2
        contador += 1
        Try GridViewBetStars[fila - 1, 1].text = Mid$(Trim(lineas[contador]), 1, 6) 'hora
    Wend

    TextAreaBetStarsFutbol.pos = 1

End

Private Function esletra(inicialLetra As String) As Boolean

    If inicialLetra = "L" Then Return True
    If inicialLetra = "M" Then Return True
    If inicialLetra = "J" Then Return True
    If inicialLetra = "V" Then Return True
    If inicialLetra = "S" Then Return True
    If inicialLetra = "D" Then Return True
    Return False

End
